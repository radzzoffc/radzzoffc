<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Radzz | SimpleShootter</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    canvas {
      background: linear-gradient(to bottom, #0f172a, #1e293b);
      border-radius: 1rem;
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
      touch-action: none;
    }
    ::selection { background: #0ff; color: #000; }
  </style>
</head>
<body class="bg-gray-950 text-white font-sans flex flex-col min-h-screen">
  <header class="bg-gray-800 text-center py-4 shadow-md">
    <h1 class="text-2xl font-bold tracking-wider text-cyan-400">RDZZ SSHOOTER</h1>
    <p class="text-sm text-gray-400">3 bola tembus ke bawah, defeat aowkwowkwk</p>
  </header>

  <main class="flex-grow flex flex-col items-center justify-center p-4 space-y-4">
    <div class="space-x-2">
      <button id="startBtn" class="bg-cyan-600 hover:bg-cyan-700 px-4 py-2 rounded-full text-sm uppercase shadow">Mulai</button>
      <button id="restartBtn" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded-full text-sm uppercase shadow hidden">Restart</button>
    </div>
    <div class="text-lg">
      Score: <span id="score" class="text-yellow-400 font-bold">0</span>
    </div>
    <div class="w-full max-w-xs text-left">
  <h2 class="text-cyan-400 font-semibold mb-2">Leaderboard Global</h2>
  <ul id="leaderboard" class="space-y-1 text-sm text-gray-300"></ul>
</div>
    <canvas id="gameCanvas" width="320" height="480"></canvas>
  </main>

  <footer class="bg-gray-800 text-center py-3 text-sm text-gray-500">
    &copy; RADZZOFFC
  </footer>

  <script>
    alert("Welkamm, Main aja kalo gabut\n\nDeveloped by Radzz");

    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const scoreDisplay = document.getElementById("score");
    const startBtn = document.getElementById("startBtn");
    const restartBtn = document.getElementById("restartBtn");

    let player, bullets, enemies, score, missed, gameLoop, shootingLoop, playing = false;
    const defeatLimit = 3;

    const initGame = () => {
      player = { x: canvas.width / 2 - 15, y: canvas.height - 50, w: 30, h: 30 };
      bullets = [];
      enemies = [];
      score = 0;
      missed = 0;
      spawnEnemies();
      updateScore();
    };

    const spawnEnemies = () => {
      enemies = [];
      for (let i = 0; i < 6; i++) {
        enemies.push({ x: Math.random() * (canvas.width - 30), y: -60 * i, w: 30, h: 30, speed: 1 + Math.random() * 1.5 });
      }
    };

    const updateScore = () => {
      scoreDisplay.textContent = score;
    };

    const drawPlayer = () => {
      ctx.fillStyle = "#0ff";
      ctx.beginPath();
      ctx.moveTo(player.x + player.w / 2, player.y);
      ctx.lineTo(player.x, player.y + player.h);
      ctx.lineTo(player.x + player.w, player.y + player.h);
      ctx.closePath();
      ctx.fill();
    };

    const drawBullets = () => {
      ctx.fillStyle = "#facc15";
      bullets.forEach(b => ctx.fillRect(b.x, b.y, b.w, b.h));
    };

    const drawEnemies = () => {
      ctx.fillStyle = "#22c55e";
      enemies.forEach(e => {
        ctx.beginPath();
        ctx.arc(e.x + e.w / 2, e.y + e.h / 2, e.w / 2, 0, Math.PI * 2);
        ctx.fill();
      });
    };

    const moveBullets = () => {
      bullets = bullets.filter(b => b.y > -b.h);
      bullets.forEach(b => b.y -= 6);
    };

    const moveEnemies = () => {
      enemies.forEach((e, i) => {
        e.y += e.speed;
        if (e.y > canvas.height) {
          missed++;
          enemies[i] = { x: Math.random() * (canvas.width - 30), y: -50, w: 30, h: 30, speed: 1 + Math.random() * 1.5 };
          if (missed >= defeatLimit) gameOver();
        }
      });
    };

    const detectCollision = () => {
      bullets.forEach((b, bi) => {
        enemies.forEach((e, ei) => {
          if (b.x < e.x + e.w && b.x + b.w > e.x && b.y < e.y + e.h && b.y + b.h > e.y) {
            enemies[ei] = { x: Math.random() * (canvas.width - 30), y: -50, w: 30, h: 30, speed: 1 + Math.random() * 1.5 };
            bullets.splice(bi, 1);
            score++;
            updateScore();
          }
        });
      });
    };

    const render = () => {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawPlayer();
      drawBullets();
      drawEnemies();
    };

    const update = () => {
      if (!playing) return;
      moveBullets();
      moveEnemies();
      detectCollision();
      render();
    };

    const shoot = () => {
      bullets.push({ x: player.x + player.w / 2 - 2, y: player.y, w: 4, h: 10 });
    };

    const gameStart = () => {
      initGame();
      playing = true;
      restartBtn.classList.remove("hidden");
      gameLoop = setInterval(update, 1000 / 60);
      shootingLoop = setInterval(() => { if (playing) shoot(); }, 300);
    };

    const gameRestart = () => {
      clearInterval(gameLoop);
      clearInterval(shootingLoop);
      gameStart();
    };

    const leaderboardEl = document.getElementById("leaderboard");

const fetchLeaderboard = async () => {
  const res = await fetch("http://be.radzzoffc.site:3000/api/leaderboard");
  const data = await res.json();
  leaderboardEl.innerHTML = data.map((entry, i) => `
    <li class="flex justify-between border-b border-gray-700 py-1 px-2">
      <span class="text-cyan-300">${i + 1}. ${entry.name}</span>
      <span class="text-yellow-300">${entry.score}</span>
    </li>
  `).join('');
};

const saveScore = async (score) => {
  const name = prompt("Masukkan nama kamu:") || "Player";
  await fetch("http://be.radzzoffc.site:3000/api/leaderboard", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ name, score })
  });
  fetchLeaderboard();
};

const gameOver = () => {
  playing = false;
  clearInterval(gameLoop);
  clearInterval(shootingLoop);
  alert("GAME OVER, Skor: " + score);
  saveScore(score);
};

fetchLeaderboard();

    document.addEventListener("keydown", (e) => {
      if (!playing) return;
      if (e.key === "ArrowLeft" && player.x > 0) player.x -= 10;
      if (e.key === "ArrowRight" && player.x < canvas.width - player.w) player.x += 10;
    });

    let touchActive = false;
    canvas.addEventListener("touchstart", (e) => {
      touchActive = true;
      const touchX = e.touches[0].clientX - canvas.getBoundingClientRect().left;
      player.x = Math.min(Math.max(touchX - player.w / 2, 0), canvas.width - player.w);
    });

    canvas.addEventListener("touchmove", (e) => {
      if (!touchActive || !playing) return;
      e.preventDefault();
      const touchX = e.touches[0].clientX - canvas.getBoundingClientRect().left;
      player.x = Math.min(Math.max(touchX - player.w / 2, 0), canvas.width - player.w);
    });

    canvas.addEventListener("touchend", () => {
      touchActive = false;
    });

    startBtn.onclick = gameStart;
    restartBtn.onclick = gameRestart;
    
    document.addEventListener('contextmenu', function(e) {
  e.preventDefault();
  alert("Akses klik kanan diblokir");
});

document.onkeydown = function(e) {
  if (e.keyCode == 123) {
    alert("Akses Developer Tools diblokir");
    return false;
  }
  if (e.ctrlKey && (e.shiftKey && (e.keyCode == 73 || e.keyCode == 74 || e.keyCode == 67)) || 
      e.ctrlKey && (e.keyCode == 85 || e.keyCode == 83)) {
    alert("Shortcut DevTools diblokir");
    return false;
  }
};

let devtools = {
  open: false,
  orientation: null,
};
(function() {
  const threshold = 160;
  setInterval(function() {
    const widthThreshold = window.outerWidth - window.innerWidth > threshold;
    const heightThreshold = window.outerHeight - window.innerHeight > threshold;
    if (widthThreshold || heightThreshold) {
      if (!devtools.open) {
        alert("DevTools terdeteksi, Akses diblokir");
      }
      devtools.open = true;
    } else {
      devtools.open = false;
    }
  }, 1000);
})();
  </script>
</body>
</html>
